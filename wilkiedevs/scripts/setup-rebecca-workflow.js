// Script para configurar y verificar el workflow completo de Rebecca
console.log('ğŸš€ Configurador del Workflow de Rebecca\n');

console.log('ğŸ“‹ ESTADO ACTUAL DEL PROYECTO:');
console.log('âœ… CÃ³digo del chatbot implementado');
console.log('âœ… Sistema RAG configurado');
console.log('âœ… Base de conocimientos poblada');
console.log('âœ… IntegraciÃ³n con Supabase activa');
console.log('âŒ Workflow de N8N inactivo (404 errors)');

console.log('\nğŸ¯ WORKFLOW OBJETIVO:');
console.log('   ID: y8d3eOzMf5y9Uzbc');
console.log('   URL: https://n8n.wilkiedevs.com/workflow/y8d3eOzMf5y9Uzbc');
console.log('   Webhook: c4ce0742-8638-47b6-9507-a8bd7bb63896');

console.log('\nğŸ“ PASOS PARA COMPLETAR LA CONFIGURACIÃ“N:\n');

console.log('1. ğŸŒ ACCEDER AL WORKFLOW:');
console.log('   - Abre: https://n8n.wilkiedevs.com/workflow/y8d3eOzMf5y9Uzbc');
console.log('   - Inicia sesiÃ³n si es necesario');

console.log('\n2. âš¡ ACTIVAR EL WORKFLOW:');
console.log('   - Busca el toggle "Active" en la esquina superior derecha');
console.log('   - Haz clic para activarlo (debe ponerse verde/azul)');
console.log('   - Guarda el workflow (Ctrl+S o botÃ³n Save)');

console.log('\n3. ğŸ”§ VERIFICAR CONFIGURACIÃ“N DEL WEBHOOK:');
console.log('   - Busca el nodo "Webhook" en el workflow');
console.log('   - Verifica que el Webhook ID sea: c4ce0742-8638-47b6-9507-a8bd7bb63896');
console.log('   - AsegÃºrate de que estÃ© configurado como POST');
console.log('   - Verifica que acepte JSON');

console.log('\n4. ğŸ”‘ CONFIGURAR CREDENCIALES:');
console.log('   - Supabase URL: https://ziglshuhhtsthwedrous.supabase.co');
console.log('   - Supabase Key: (usar la anon key del proyecto)');
console.log('   - OpenAI/Gemini API Key: (configurar segÃºn el modelo usado)');

console.log('\n5. ğŸ§ª PROBAR EL WORKFLOW:');
console.log('   - Usa el botÃ³n "Test Workflow" en N8N');
console.log('   - EnvÃ­a un mensaje de prueba como:');
console.log('     {');
console.log('       "chatInput": "Hola Rebecca",');
console.log('       "sessionId": "test-123",');
console.log('       "userId": "test-user"');
console.log('     }');

console.log('\n6. âœ… VERIFICAR RESPUESTA:');
console.log('   - El workflow debe procesar el mensaje');
console.log('   - Debe generar una respuesta de Rebecca');
console.log('   - Debe guardar la conversaciÃ³n en Supabase');

console.log('\nğŸ”„ ESTRUCTURA ESPERADA DEL WORKFLOW:\n');

console.log('ğŸ“¥ Webhook Trigger');
console.log('   â†“');
console.log('ğŸ§  Procesamiento de IA (Intent Recognition)');
console.log('   â†“');
console.log('ğŸ” BÃºsqueda RAG (Knowledge Base)');
console.log('   â†“');
console.log('ğŸ’¬ GeneraciÃ³n de Respuesta (GPT/Gemini)');
console.log('   â†“');
console.log('ğŸ’¾ Guardar en Supabase');
console.log('   â†“');
console.log('ğŸ“¤ Respuesta al Cliente');

console.log('\nğŸš¨ PROBLEMAS COMUNES Y SOLUCIONES:\n');

console.log('âŒ Error 404 en webhook:');
console.log('   â†’ El workflow no estÃ¡ activo');
console.log('   â†’ Activar el workflow en N8N');

console.log('\nâŒ Error 500 en webhook:');
console.log('   â†’ Credenciales incorrectas');
console.log('   â†’ Verificar API keys de Supabase/OpenAI');

console.log('\nâŒ Sin respuesta del workflow:');
console.log('   â†’ Nodos mal conectados');
console.log('   â†’ Verificar flujo de datos entre nodos');

console.log('\nâŒ Error de base de datos:');
console.log('   â†’ Tablas no existen');
console.log('   â†’ Ejecutar scripts de poblaciÃ³n de datos');

console.log('\nğŸ§ª COMANDOS DE PRUEBA:\n');

console.log('# Verificar estado del workflow');
console.log('node scripts/activate-n8n-workflow.js');

console.log('\n# Probar sistema completo');
console.log('node scripts/test-rebecca-complete-system.js');

console.log('\n# Poblar base de conocimientos');
console.log('node scripts/populate-knowledge-base.js');

console.log('\n# Probar sistema RAG');
console.log('node scripts/test-rag-system.js');

console.log('\nğŸ“Š MÃ‰TRICAS DE Ã‰XITO:\n');

console.log('âœ… Webhook responde (no 404)');
console.log('âœ… Rebecca genera respuestas coherentes');
console.log('âœ… Conversaciones se guardan en Supabase');
console.log('âœ… Leads se capturan automÃ¡ticamente');
console.log('âœ… Sistema RAG encuentra informaciÃ³n relevante');

console.log('\nğŸ‰ UNA VEZ CONFIGURADO:\n');

console.log('1. El chatbot estarÃ¡ completamente funcional');
console.log('2. Rebecca responderÃ¡ inteligentemente');
console.log('3. Se capturarÃ¡n leads automÃ¡ticamente');
console.log('4. Se generarÃ¡n cotizaciones automÃ¡ticas');
console.log('5. Todo se integrarÃ¡ con el sistema existente');

console.log('\nğŸ”— RECURSOS ÃšTILES:\n');

console.log('- Workflow URL: https://n8n.wilkiedevs.com/workflow/y8d3eOzMf5y9Uzbc');
console.log('- Supabase Dashboard: https://supabase.com/dashboard');
console.log('- DocumentaciÃ³n N8N: https://docs.n8n.io/');

console.log('\nğŸ’¡ SIGUIENTE PASO INMEDIATO:');
console.log('   ğŸ‘‰ Abre el workflow en N8N y actÃ­valo');
console.log('   ğŸ‘‰ Luego ejecuta: node scripts/test-rebecca-complete-system.js');

console.log('\nâœ¨ Â¡El sistema estÃ¡ casi listo! Solo falta activar el workflow.');